import{_ as z,X as Y,W as ee,U as ae,Z as c,ag as te,ah as F,$ as le,G as m,H as V,J as a,a2 as oe,o as e,K as L,N as A,L as T,ai as D,ak as se,a0 as ne,ar as I,P as d,Q as w,bd as re,as as N,at as R,O as x,aq as ue,a1 as r,am as ie,an as g,q as E,au as de}from"./index-775ca1ee.js";import{e as _,c as ce,f as me,a as pe,u as ve,V as fe}from"./index.esm-b06ce4fb.js";import{V as Ve,a as M,b as P}from"./VRow-453d8268.js";import{V as ge,a as _e}from"./VCarouselItem-e6994b87.js";import{V as be,a as Ce}from"./VCombobox-3ad4dfa2.js";import{V as ye}from"./filter-932b5e6a.js";import{a as he}from"./VList-7df298df.js";import{V as ke}from"./VTextarea-92c6683f.js";import"./ssrBoot-3bb5178d.js";import"./VCheckboxBtn-53b4c851.js";import"./VSlideGroup-2a90fa20.js";import"./VDivider-ee7db21c.js";const we={__name:"ProductCard",setup(xe){const{api:H,apiAuth:G}=oe(),b=Y(),p=ee(),C=ae(),v=_("quantity"),y=c([]),u=c([]),J=n=>{C.push(`/products/${n}`)},K=async()=>{var n,t;if(!b.isLogin){C.push("/login");return}try{console.log(u.value._id);const{data:s}=await G.patch("/users/cart",{product:u.value._id,quantity:v.value.value});b.cart=s.result,p({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:1500,color:"#8C8987",location:"center"}}),h()}catch(s){console.log(s);const o=((t=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";p({text:o,showCloseButton:!1,snackbarProps:{timeout:1500,color:"error",location:"center"}})}},f=c(!1),O=async n=>{if(!b.isLogin){C.push("/login");return}f.value=!0,u.value.name=n.name,u.value.price=n.price,u.value._id=n._id,await F(),console.log(n.name),console.log(u.value.name),S({values:{name:u.value.name,price:u.value.price,quantity:{value:1}}})},h=()=>{f.value=!1,S()},Q=ce({quantity:me().typeError("格式錯誤").required("缺少數量").min(1,"數量最少為 1"),name:pe().required("缺少師傅姓名")}),{handleSubmit:W,isSubmitting:k,resetForm:S}=ve({validationSchema:Q,initialValues:{quantity:{value:1},description:""}}),q=_("name"),B=_("price"),U=_("description"),X=W(async n=>{var t,s;try{p({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:1500,color:"#8C8987",location:"center"}}),h()}catch(o){console.log(o);const l=((s=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";p({text:l,showCloseButton:!1,snackbarProps:{timeout:1500,color:"error",location:"center"}})}}),$=c(),Z=c(!1),j=c([{names:" 頭 "},{names:" 頸 "},{names:" 肩 "},{names:" 背 "},{names:" 手 "},{names:" 臀 "},{names:" 腿 "},{names:" 腳底 "},{names:" 上半身 "},{names:" 下半身 "},{names:" 全身 "}]);return te(async()=>{var n,t;try{const{data:s}=await H.get("/products",{params:{itemsPerPage:-1}});return y.value.push(...s.result.data),await F(),console.log(y.value),u}catch(s){console.log(s);const o=((t=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";p({text:o,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),(n,t)=>{const s=le("RouterLink");return m(),V(Ve,null,{default:a(()=>[e(M,null,{default:a(()=>[(m(!0),L(T,null,A(y.value,o=>(m(),V(P,{cols:"12",md:"6",lg:"3",key:o._id},{default:a(()=>[e(D,{class:"card"},{default:a(()=>[o.image&&o.image.length>0?(m(),V(ge,{key:0,"show-arrows":"hover","hide-delimiters":"",progress:"#403635"},{default:a(()=>[(m(!0),L(T,null,A(o.image,(l,i)=>(m(),V(_e,{key:i},{default:a(()=>[e(se,{src:l,height:"100vh",onClick:Pe=>J(o._id)},null,8,["src","onClick"])]),_:2},1024))),128))]),_:2},1024)):ne("",!0),e(I,null,{default:a(()=>[e(s,{class:"color text-decoration-none",to:"/products/"+o._id},{default:a(()=>[d(w(o.name),1)]),_:2},1032,["to"])]),_:2},1024),e(re,null,{default:a(()=>[d("一小時 $"+w(o.price),1)]),_:2},1024),e(N,{class:"clamp-text",style:{"white-space":"pre-wrap"}},{default:a(()=>[d(w(o.description),1)]),_:2},1024),e(R,null,{default:a(()=>[e(x,{color:"#5FA5AE","prepend-icon":"mdi-clock-time-three-outline",onClick:l=>O(o)},{default:a(()=>[d("選擇時段")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(ue,{class:"w-75",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l)},{default:a(()=>[e(fe,{disabled:r(k),onSubmit:ie(r(X),["prevent"])},{default:a(()=>[e(D,null,{default:a(()=>[e(I,null,{default:a(()=>[d("選擇師傅")]),_:1}),e(N,null,{default:a(()=>[e(g,{modelValue:r(q).value.value,"onUpdate:modelValue":t[0]||(t[0]=l=>r(q).value.value=l),variant:"outlined",disabled:""},null,8,["modelValue"]),e(g,{label:"價格/1H",modelValue:r(B).value.value,"onUpdate:modelValue":t[1]||(t[1]=l=>r(B).value.value=l),disabled:""},null,8,["modelValue"]),e(be,{modelValue:$.value,"onUpdate:modelValue":t[2]||(t[2]=l=>$.value=l),disabled:Z.value,items:j.value,chips:"","closable-chips":"",color:"blue-grey-lighten-2","item-title":"names","item-value":"names",label:"Select",multiple:""},{chip:a(({products:l,item:i})=>[e(ye,E(l,{"prepend-avatar":i.raw.avatar,text:i.raw.names}),null,16,["prepend-avatar","text"])]),item:a(({products:l,item:i})=>[e(he,E(l,{"prepend-avatar":i.raw.avatar,title:i.raw.names,subtitle:i.raw.group}),null,16,["prepend-avatar","title","subtitle"])]),_:1},8,["modelValue","disabled","items"]),e(Ce,{label:"時段選擇",items:["中午時段","下午時段","晚上時段"]}),e(ke,{label:"備註",modelValue:r(U).value.value,"onUpdate:modelValue":t[3]||(t[3]=l=>r(U).value.value=l)},null,8,["modelValue"]),e(M,null,{default:a(()=>[e(P,{cols:"6"},{default:a(()=>[e(g,{label:"時數",type:"text",inputmode:"numeric",min:"0",modelValue:r(v).value.value,"onUpdate:modelValue":t[4]||(t[4]=l=>r(v).value.value=l),"error-messages":r(v).errorMessage.value,clearable:""},null,8,["modelValue","error-messages"])]),_:1}),e(P,{cols:"6"},{default:a(()=>[e(g,{type:"date"})]),_:1})]),_:1})]),_:1}),e(R,null,{default:a(()=>[e(de),e(x,{color:"red",disabled:r(k),onClick:h},{default:a(()=>[d("取消")]),_:1},8,["disabled"]),e(x,{color:"green",type:"submit",loading:r(k),onClick:K},{default:a(()=>[d("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])]),_:2},1024))),128))]),_:1})]),_:1})}}},Re=z(we,[["__scopeId","data-v-76a4065b"]]);export{Re as default};
